{% extends "base.html" %}
{% block content %}
  <section class="ninegrid" aria-label="Nine quadrant selection">
    <!-- Top row: logos only -->
    <div class="quad" data-key="q" data-id="1" aria-label="Snake">
      <a href="/snake" title="Snake">
        <img class="logo" src="{{ url_for('static', path='img/snake.png') }}" alt="Snake logo">
      </a>
    </div>
    <div class="quad" data-key="w" data-id="2" aria-label="Pong">
      <a href="/pong" title="Pong">
        <img class="logo" src="{{ url_for('static', path='img/pong.png') }}" alt="Pong logo">
      </a>
    </div>
    <div class="quad" data-key="e" data-id="3" aria-label="Minecraft">
      <a href="#" title="Minecraft">
        <img class="logo" src="{{ url_for('static', path='img/minecraft.png') }}" alt="Minecraft logo">
      </a>
    </div>

    <!-- Middle row -->
    <div class="quad" data-key="a" data-id="4"></div>
    <div class="quad" data-key="s" data-id="5"></div>
    <div class="quad" data-key="d" data-id="6"></div>

    <!-- Bottom row -->
    <div class="quad" data-key="z" data-id="7"></div>
    <div class="quad" data-key="x" data-id="8"></div>
    <div class="quad" data-key="c" data-id="9"></div>
  </section>

  <div aria-live="polite" aria-atomic="true" class="sr-only" id="live"></div>

  <script>
    (function () {
      const quads = Array.from(document.querySelectorAll('.ninegrid .quad'));
      const byKey = Object.fromEntries(quads.map(q => [q.dataset.key, q]));
      const live = document.getElementById('live');
      let lastKey = null, lastTime = 0;
      const DOUBLE_PRESS_MS = 800;

      function clearState() { quads.forEach(el => el.classList.remove('active','hover')); }
      function setActive(q) {
        clearState();
        if (q) {
          q.classList.add('active');
          live.textContent = `Selected ${q.dataset.id}`;
          setTimeout(() => q.classList.remove('active'), 900);
        }
      }
      function activate(q) {
        const link = q.querySelector('a');
        if (link) link.click();
      }

      // Keyboard: qwe/asd/zxc
      document.addEventListener('keydown', (e) => {
        const key = e.key.toLowerCase();
        const q = byKey[key];
        if (!q) return;
        const now = performance.now();
        const isDouble = (key === lastKey) && ((now - lastTime) <= DOUBLE_PRESS_MS);
        setActive(q);
        if (isDouble) activate(q);
        lastKey = key; lastTime = now;
      });

      // Mouse hover: add/remove .hover for glow
      quads.forEach(q => {
        q.addEventListener('mouseenter', () => {
          clearState();
          q.classList.add('hover');
        });
        q.addEventListener('mouseleave', () => q.classList.remove('hover'));
      });

      // (Future) EOG “hover”: when you have a target quadrant index (1–9),
      // call: clearState(); quads[targetIndex-1].classList.add('hover');
    })();
  </script>

{% endblock %}
